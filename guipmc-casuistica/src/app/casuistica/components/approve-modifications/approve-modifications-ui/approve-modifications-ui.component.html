<app-navbar></app-navbar>
<app-breadcrumb-ux [titulo]="titulo"></app-breadcrumb-ux>
<br>
<br>
<main class="page">
    <div class="container">
        <form class="form-inline" [formGroup]="formGroup" (ngSubmit)="aprobarMovimiento()">
            <br>
            <div class="row table-responsive">
                <table class="table  table-striped">
                    <tbody>
                        <tr>
                            <th>Datos del asegurado</th>
                        </tr>
                        <tr>
                            <td>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>CURP</p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.refCurp}}" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>NSS*</p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.numNss}}" type="text" disabled>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-8 izqText">
                                        <p>Nombre(s) y apellidos </p>
                                        <input class="form-control" style="width: 95%;"
                                            value="{{info.aseguradoDTO.nombreCompleto}}" type="text" disabled>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p> Delegación del NSS</p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.desDelegacionNss}}" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Subdelegación del NSS</p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.desSubDelNss}}" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>UMF de adscripción</p>
                                        <input class="form-control" value="{{info.aseguradoDTO.desUmfAdscripcion}}"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Delegación Atención del NSS</p>
                                        <input class="form-control" style="width: 90%;"
                                            value="{{info.aseguradoDTO.desDelegacionAtencion}}" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Subdelegación de Atención del NSS</p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.desSubDelAtencion}}" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>UMF de expedición</p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.desUmfExp}}" type="text" disabled>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>UMF pagadora</p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.desUmfPagadora}}" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p style="margin-top:0px;">Código de error</p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.desCodigoError}}" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p style="margin-top:0px;">Año ciclo </p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.numCicloAnual}}" type="text" disabled>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Tipo de registro </p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.desCasoRegistro}}" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Ocupación</p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.desOcupacion}}" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Salario diario</p>
                                        <input class="form-control inputTamanioNormal"
                                            value="{{info.aseguradoDTO.numSalarioDiario}}" type="text" disabled>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <br>
            <!--       TABLA DE LA INCAPACIDAD     -->
            <div class="row table-responsive">
                <table class="table  table-striped">
                    <tbody>
                        <tr>
                            <th>Datos de la incapacidad</th>
                        </tr>
                        <tr>
                            <td style="text-align: center">
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Fecha de inicio*</p>
                                        <input class="form-control"
                                            [value]="info.incapacidadDTO.fecInicio | date:'dd/MM/yyyy'"
                                            class="form-control " style="width: 90%;" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Fecha de atención</p>
                                        <input class="form-control"
                                            [value]="info.incapacidadDTO.fecAtencion | date:'dd/MM/yyyy'"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Fecha de accidente</p>
                                        <input class="form-control"
                                            [value]="info.incapacidadDTO.fecAccidente | date:'dd/MM/yyyy'"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Fecha inicio de pensión </p>
                                        <input class="form-control"
                                            [value]="info.incapacidadDTO.fecIniPension | date:'dd/MM/yyyy'"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Fecha de alta</p>
                                        <input class="form-control"
                                            [value]="info.incapacidadDTO.fecAltaIncapacidad | date:'dd/MM/yyyy'"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Fecha de expedici&oacute;n del dictamen</p>
                                        <input class="form-control" style="width: 90%;"
                                            [value]="info.incapacidadDTO.fecExpDictamen | date:'dd/MM/yyyy'" type="text"
                                            disabled>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Fecha fin* </p>
                                        <input class="form-control" style="width: 90%;"
                                            [value]="info.incapacidadDTO.fecFin | date:'dd/MM/yyyy'" type="text"
                                            disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Días subsidiados*</p>
                                        <input class="form-control" [value]="info.incapacidadDTO.numDiasSubsidiados"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Porcentaje de incapacidad* </p>
                                        <input class="form-control" style="width: 90%;"
                                            [value]="info.incapacidadDTO.porPorcentajeIncapacidad" type="text" disabled>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Causa externa</p>
                                        <input class="form-control" style="width: 90%;"
                                            [value]="info.incapacidadDTO.desCausaExterna" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p style="margin-top:0px;">Naturaleza</p>
                                        <input class="form-control" style="width: 90%;"
                                            [value]="info.incapacidadDTO.desNaturaleza" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p style="margin-top:0px;">Riesgo físico</p>
                                        <input class="form-control" [value]="info.incapacidadDTO.desRiesgoFisico"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Acto ineguro</p>
                                        <input class="form-control" [value]="info.incapacidadDTO.desActoInseguro"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p style="margin-top:0px;">Tipo de riesgo* </p>
                                        <input class="form-control" [value]="info.incapacidadDTO.desTipoRiesgo"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p style="margin-top:0px;">Consecuencia* </p>
                                        <input class="form-control" [value]="info.incapacidadDTO.desConsecuencia"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Laudo</p>
                                        <input class="form-control" [value]="info.incapacidadDTO.desLaudo"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Matrícula del médico tratante </p>
                                        <input class="form-control" [value]="info.incapacidadDTO.numMatMedTratante"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Matrícula del médico que autoriza CDST</p>
                                        <input class="form-control" style="width: 90%;"
                                            [value]="info.incapacidadDTO.numMatMedAutCdst" type="text" disabled>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>C&oacute;digo del diagn&oacute;stico</p>
                                        <input class="form-control" [value]="info.incapacidadDTO.desCodigoDiagnostico"
                                            style="width: 90%;" type="text" disabled>
                                    </div>
                                    <div class="col-md-4" style="margin-top:0px; text-align: left;">
                                        <p>Tipo de incapacidad</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.incapacidadDTO.desTipoIncapacidad !== undefined? info.incapacidadDTO.desTipoIncapacidad : ''">
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Tipo Dictamen</p>
                                        <input class="form-control" [value]="getTipoDictamen()" style="width: 90%;"
                                            type="text" disabled>
                                    </div>
                                    <div class="col-md-4" style="margin-top:0px; text-align: left;">
                                        <p>Folio</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="getNumeroDictamen()">
                                    </div>
                                    <div class="col-md-4" style="margin-top:15px; text-align: left;">
                                        <p> </p>
                                        <button type="button" (click)="dictamen()" *ngIf="showBtnDictamen"
                                            class="btn btn-success-pmc">Dictamen SIST</button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <br>
            <!--       TABLA DATOS DEL PATRON     -->
            <div class="row table-responsive">
                <table class="table  table-striped">
                    <tbody>
                        <tr>
                            <th>Datos del patrón</th>
                        </tr>
                        <tr>
                            <td style="text-align: center">
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Registro Patronal*</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.patronDTO.refRegistroPatronal">
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>RFC</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.patronDTO.desRfc">
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Clase</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.patronDTO.desClase">
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Actividad económica</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.patronDTO.desFraccion">
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Prima</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.patronDTO.numPrima">
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Delegación del Registro Patronal</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.patronDTO.desDelRegPatronal">
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Subdelagación del Registro Patronal</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.patronDTO.desSubDelRegPatronal">
                                    </div>
                                    <div class="col-md-8 izqText">
                                        <p>Razón Social del Patrón </p>
                                        <input class="form-control " style="width: 95%;" type="text" disabled
                                            [value]="info.patronDTO.desRazonSocial">
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!--       TABLA DEL REGISTRO   -->
            <div class="row table-responsive">
                <table class="table  table-striped">
                    <tbody>
                        <tr>
                            <th>Datos del registro</th>
                        </tr>
                        <tr>
                            <td style="text-align: center">
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Acción del registro</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.auditorias !== null && info.auditorias[0].desAccionRegistro !== null ? info.auditorias[0].desAccionRegistro : ''">
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Situación del Registro</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.desSituacionRegistro !== undefined ? info.desSituacionRegistro : ''">

                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-4 izqText">
                                        <p>Fecha del cambio</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.aseguradoDTO.fecActualizacion | dateString">
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Hora del cambio</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.aseguradoDTO.fecActualizacion | dateString : 'hours'">
                                    </div>
                                    <div class="col-md-4 izqText">
                                        <p>Cuenta de Usuario</p>
                                        <input class="form-control inputTamanioNormal" type="text" disabled
                                            [value]="info.aseguradoDTO.usuarioModificador ? info.aseguradoDTO.usuarioModificador : ''">
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!--      FIN TABLA DE LA INCAPACIDAD     -->
            <!--      TABLA DE COMENTARIOS       -->
            <div class="row table-responsive">
                <table class="table  table-striped">
                    <tbody>
                        <tr>
                            <th>Observaciones del Solicitante</th>
                        </tr>
                        <tr>
                            <td style="text-align: center">
                                <div class="row">
                                    <div class="col-md-12 izqText">
                                        <textarea class="form-control" style="width: 100%;" rows="3"
                                            [value]="info.desObservacionesSol" disabled></textarea>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!--      FIN TABLA DE COMENTARIOS   -->
            <!--      TABLA DE OBSERVADORES DEL APROBADOR     -->
            <div class="row table-responsive">
                <table class="table  table-striped">
                    <tbody>
                        <tr>
                            <th>Observaciones del Aprobador</th>
                        </tr>
                        <tr>
                            <td style="text-align: center">
                                <div class="row">
                                    <div class="col-md-12 izqText">
                                        <p>Comentarios*</p>
                                        <textarea
                                            [ngClass]="[!formGroup.controls['comentarioAprobador'].valid && formGroup.controls['comentarioAprobador'].touched ? 'form-control-error':'form-control']  "
                                            class="form-control" style="width: 100%;" rows="3"
                                            formControlName="comentarioAprobador"></textarea>
                                        <div style="width: max-content;"
                                            *ngIf="!formGroup.controls['comentarioAprobador'].valid">
                                            <div
                                                *ngIf=" formGroup.controls['comentarioAprobador'].errors?.required && formGroup.controls['comentarioAprobador'].touched">
                                                <p class="error-class"> *Campo obligatorio </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!--      FIN TABLA DE COMENTARIOS   -->
            <br>
            <div class="row">
                <div class="col-md-2 text-left">
                    <p>*Datos obligatorios</p>
                </div>
                <div class="col-md-10 text-right">
                    <button type="button" (click)="regresar()" class="btn btn-default">Regresar</button> &nbsp;
                    <button type="button" (click)="rechazarMovimiento()" class="btn btn-primary">Rechazar
                        movimiento</button> &nbsp;
                    <button type="button" (click)="aprobarSinCambiosConfirmacion()" class="btn btn-default"
                        id="btnEliminar" *ngIf="esAprobarSinCambios()">Aprobar sin cambios</button>

                    <button type="submit" class="btn btn-primary" *ngIf="!esAprobarSinCambios()">Aprobar
                        movimiento</button>
                </div>
            </div>
            <div class="modal fade" id="dialogMessage">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">{{titDialogo}}</h4>
                        </div>
                        <div class="modal-body">
                            <h3>{{messDialogo}}</h3>
                        </div>
                        <div class="modal-footer">
                            <div class="col-md-12 text-right">
                                <button type="button" class="btn btn-primary" (click)="hideMessage()">Regresar</button>
                                &nbsp;
                                <button *ngIf="mostrarSi" type="button" class="btn btn-primary"
                                    (click)="siGuardar()">Si</button> &nbsp;
                                <button *ngIf="mostrarRechazoSi" type="button" class="btn btn-primary"
                                    (click)="siRechazar()">Si </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="dialogMessageV2">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">{{titDialogo}}</h4>
                        </div>
                        <div class="modal-body">
                            <h3>{{messDialogo}} </h3>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" (click)="hideMessageV2()">Regresar</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="dialogMessageConfirmAprobar">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">{{titDialogo}}</h4>
                        </div>
                        <div class="modal-body">
                            <h3>{{messDialogo}}</h3>
                        </div>
                        <div class="modal-footer">
                            <div class="col-md-12 text-right">
                                <button type="button" class="btn btn-primary" [disabled]="isDisabledConfirmar"
                                (click)="confirmarAprobar()">Si</button>
                                &nbsp;
                                <button type="button" class="btn btn-primary"
                                    (click)="cancelarConfirmarAprobar()">No</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
                aria-hidden="true" id="modalFiles">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">{{titDialogo}}</h4>
                        </div>
                        <div class="modal-body">
                            <object #pdfview [data]='' type="application/pdf" width="100%" height="500px">
                            </object>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" (click)="imprimir()">Imprimir</button>
                            <button type="button" class="btn btn-primary"
                                (click)="downloadDictamen()">Descargar</button>
                            <button type="button" class="btn btn-primary" (click)="closeModal()">Regresar</button>
                        </div>
                    </div>
                </div>
            </div>

        </form>
    </div>
    <br>
    <br>
    <br>
</main>
<ngx-spinner></ngx-spinner>